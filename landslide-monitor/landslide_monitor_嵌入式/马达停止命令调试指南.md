# é©¬è¾¾åœæ­¢å‘½ä»¤è°ƒè¯•æŒ‡å—

## é—®é¢˜ç°çŠ¶

ç”¨æˆ·åé¦ˆï¼šåœæ­¢å‘½ä»¤ä»ç„¶è§£æä¸åˆ°ï¼Œæ— æ³•æ­£å¸¸åœæ­¢é©¬è¾¾ã€‚

## ğŸ” **è°ƒè¯•æ­¥éª¤**

### **æ­¥éª¤1ï¼šæ£€æŸ¥å‘½ä»¤æ ¼å¼**

ç¡®ä¿æ‚¨å‘é€çš„åœæ­¢å‘½ä»¤æ ¼å¼æ­£ç¡®ï¼š

#### **âœ… æ­£ç¡®çš„åœæ­¢å‘½ä»¤æ ¼å¼**
```json
{
  "service_id": "smartHome",
  "command_name": "control_motor",
  "paras": {
    "enable": false
  }
}
```

#### **âŒ é”™è¯¯çš„æ ¼å¼ç¤ºä¾‹**
```json
// é”™è¯¯1ï¼šç¼ºå°‘parasåŒ…è£…
{
  "service_id": "smartHome", 
  "command_name": "control_motor",
  "enable": false  // âŒ åº”è¯¥åœ¨paraså¯¹è±¡å†…
}

// é”™è¯¯2ï¼šå‚æ•°åé”™è¯¯
{
  "service_id": "smartHome",
  "command_name": "control_motor", 
  "paras": {
    "enabled": false  // âŒ åº”è¯¥æ˜¯"enable"
  }
}

// é”™è¯¯3ï¼šæ•°æ®ç±»å‹é”™è¯¯
{
  "service_id": "smartHome",
  "command_name": "control_motor",
  "paras": {
    "enable": "false"  // âŒ åº”è¯¥æ˜¯å¸ƒå°”å€¼falseï¼Œä¸æ˜¯å­—ç¬¦ä¸²"false"
  }
}
```

### **æ­¥éª¤2ï¼šæŸ¥çœ‹ä¸²å£è°ƒè¯•è¾“å‡º**

å‘é€åœæ­¢å‘½ä»¤åï¼ŒæŸ¥çœ‹ä¸²å£è¾“å‡ºï¼Œåº”è¯¥çœ‹åˆ°ä»¥ä¸‹è°ƒè¯•ä¿¡æ¯ï¼š

#### **âœ… æ­£å¸¸çš„è°ƒè¯•è¾“å‡º**
```
=== MOTOR CONTROL COMMAND ===
Full JSON received: {"command_name":"control_motor","paras":{"enable":false}}
Paras content: {"enable":false}
Parameter check:
  enable: exists (type: 1)
  speed: NULL (type: -1)
  direction: NULL (type: -1)
  duration: NULL (type: -1)
Enable parameter is boolean, value: false
*** STOPPING MOTOR *** (Stop command #1)
Raw parameters: enable=false (stop command)
Calling Motor_Off() directly...
Motor_Off() called successfully
Motor stopped directly
Double-checking motor stop...
Motor stop confirmed
```

#### **âŒ å¼‚å¸¸çš„è°ƒè¯•è¾“å‡º**

**æƒ…å†µ1ï¼šJSONè§£æå¤±è´¥**
```
=== MOTOR CONTROL COMMAND ===
ERROR: 'paras' object not found in JSON
```
**è§£å†³æ–¹æ¡ˆ**ï¼šæ£€æŸ¥JSONæ ¼å¼ï¼Œç¡®ä¿æœ‰`paras`å¯¹è±¡

**æƒ…å†µ2ï¼šenableå‚æ•°ç±»å‹é”™è¯¯**
```
=== MOTOR CONTROL COMMAND ===
Full JSON received: {"command_name":"control_motor","paras":{"enable":"false"}}
Paras content: {"enable":"false"}
Parameter check:
  enable: exists (type: 4)  // type 4 = å­—ç¬¦ä¸²ï¼Œåº”è¯¥æ˜¯ type 1 = å¸ƒå°”å€¼
ERROR: enable parameter is not boolean or missing
Enable parameter type: 4 (expected: 1 for boolean)
```
**è§£å†³æ–¹æ¡ˆ**ï¼šç¡®ä¿enableå€¼æ˜¯å¸ƒå°”ç±»å‹`false`ï¼Œä¸æ˜¯å­—ç¬¦ä¸²`"false"`

**æƒ…å†µ3ï¼šenableå‚æ•°ç¼ºå¤±**
```
=== MOTOR CONTROL COMMAND ===
Full JSON received: {"command_name":"control_motor","paras":{}}
Paras content: {}
Parameter check:
  enable: NULL (type: -1)
ERROR: enable parameter is not boolean or missing
Enable parameter is NULL
```
**è§£å†³æ–¹æ¡ˆ**ï¼šç¡®ä¿JSONä¸­åŒ…å«`enable`å‚æ•°

### **æ­¥éª¤3ï¼šæ£€æŸ¥åä¸ºäº‘IoTå¹³å°é…ç½®**

#### **è®¾å¤‡äº§å“æ¨¡å‹æ£€æŸ¥**
1. ç™»å½•åä¸ºäº‘IoTè®¾å¤‡æ¥å…¥æ§åˆ¶å°
2. è¿›å…¥äº§å“ â†’ æ¨¡å‹å®šä¹‰ â†’ å‘½ä»¤
3. ç¡®è®¤`control_motor`å‘½ä»¤å­˜åœ¨ä¸”é…ç½®æ­£ç¡®

#### **å‘½ä»¤å‚æ•°é…ç½®**
```
å‘½ä»¤æ ‡è¯†ç¬¦: control_motor
å‘½ä»¤åç§°: æ§åˆ¶é©¬è¾¾
å‚æ•°åˆ—è¡¨:
  - enable (boolean): æ˜¯å¦å¯ç”¨
  - speed (int): é€Ÿåº¦ (å¯é€‰)
  - direction (int): æ–¹å‘ (å¯é€‰) 
  - duration (int): æŒç»­æ—¶é—´ (å¯é€‰)
```

### **æ­¥éª¤4ï¼šæµ‹è¯•ä¸åŒçš„å‘½ä»¤æ ¼å¼**

#### **æµ‹è¯•1ï¼šæœ€ç®€åœæ­¢å‘½ä»¤**
```json
{
  "service_id": "smartHome",
  "command_name": "control_motor",
  "paras": {
    "enable": false
  }
}
```

#### **æµ‹è¯•2ï¼šå¸¦é¢å¤–å‚æ•°çš„åœæ­¢å‘½ä»¤**
```json
{
  "service_id": "smartHome", 
  "command_name": "control_motor",
  "paras": {
    "enable": false,
    "speed": 0,
    "direction": 0,
    "duration": 0
  }
}
```

#### **æµ‹è¯•3ï¼šå…ˆå¯åŠ¨å†åœæ­¢**
```json
// 1. å¯åŠ¨å‘½ä»¤
{
  "service_id": "smartHome",
  "command_name": "control_motor", 
  "paras": {
    "enable": true,
    "speed": 50
  }
}

// 2. åœæ­¢å‘½ä»¤
{
  "service_id": "smartHome",
  "command_name": "control_motor",
  "paras": {
    "enable": false
  }
}
```

## ğŸ› ï¸ **æ•…éšœæ’é™¤**

### **é—®é¢˜1ï¼šå‘½ä»¤æ ¹æœ¬æ²¡æœ‰åˆ°è¾¾è®¾å¤‡**
**ç—‡çŠ¶**ï¼šä¸²å£æ²¡æœ‰ä»»ä½•`=== MOTOR CONTROL COMMAND ===`è¾“å‡º
**å¯èƒ½åŸå› **ï¼š
- ç½‘ç»œè¿æ¥é—®é¢˜
- MQTTè¿æ¥æ–­å¼€
- è®¾å¤‡IDä¸åŒ¹é…
- åä¸ºäº‘å¹³å°é…ç½®é”™è¯¯

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. æ£€æŸ¥WiFiè¿æ¥çŠ¶æ€
2. æ£€æŸ¥MQTTè¿æ¥çŠ¶æ€
3. éªŒè¯è®¾å¤‡IDå’Œå¯†é’¥
4. æ£€æŸ¥åä¸ºäº‘å¹³å°è®¾å¤‡çŠ¶æ€

### **é—®é¢˜2ï¼šJSONè§£æå¤±è´¥**
**ç—‡çŠ¶**ï¼šçœ‹åˆ°`ERROR: 'paras' object not found in JSON`
**å¯èƒ½åŸå› **ï¼š
- JSONæ ¼å¼é”™è¯¯
- ç¼ºå°‘paraså¯¹è±¡
- JSONç¼–ç é—®é¢˜

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. ä½¿ç”¨JSONéªŒè¯å·¥å…·æ£€æŸ¥æ ¼å¼
2. ç¡®ä¿åŒ…å«paraså¯¹è±¡
3. æ£€æŸ¥å­—ç¬¦ç¼–ç 

### **é—®é¢˜3ï¼šå‚æ•°ç±»å‹é”™è¯¯**
**ç—‡çŠ¶**ï¼šçœ‹åˆ°`ERROR: enable parameter is not boolean`
**å¯èƒ½åŸå› **ï¼š
- enableå€¼æ˜¯å­—ç¬¦ä¸²è€Œä¸æ˜¯å¸ƒå°”å€¼
- JSONè§£æå™¨é…ç½®é—®é¢˜

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. ç¡®ä¿enableå€¼æ˜¯`false`è€Œä¸æ˜¯`"false"`
2. æ£€æŸ¥JSONç”Ÿæˆä»£ç 

### **é—®é¢˜4ï¼šé©¬è¾¾ç¡¬ä»¶ä¸å“åº”**
**ç—‡çŠ¶**ï¼šçœ‹åˆ°åœæ­¢æ—¥å¿—ä½†é©¬è¾¾ä»åœ¨è¿è¡Œ
**å¯èƒ½åŸå› **ï¼š
- ç¡¬ä»¶è¿æ¥é—®é¢˜
- é©¬è¾¾é©±åŠ¨é—®é¢˜
- ç”µæºé—®é¢˜

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. æ£€æŸ¥é©¬è¾¾ç¡¬ä»¶è¿æ¥
2. æµ‹è¯•é©¬è¾¾é©±åŠ¨ç”µè·¯
3. æ£€æŸ¥ç”µæºä¾›åº”

## ğŸ“ **è·å–å¸®åŠ©**

å¦‚æœä»¥ä¸Šæ­¥éª¤éƒ½æ— æ³•è§£å†³é—®é¢˜ï¼Œè¯·æä¾›ä»¥ä¸‹ä¿¡æ¯ï¼š

1. **å®Œæ•´çš„ä¸²å£è¾“å‡ºæ—¥å¿—**
2. **å‘é€çš„JSONå‘½ä»¤å†…å®¹**
3. **åä¸ºäº‘IoTå¹³å°çš„å‘½ä»¤å‘é€æ—¥å¿—**
4. **è®¾å¤‡ç½‘ç»œè¿æ¥çŠ¶æ€**
5. **é©¬è¾¾ç¡¬ä»¶è¿æ¥æƒ…å†µ**

è¿™æ ·å¯ä»¥æ›´å‡†ç¡®åœ°å®šä½é—®é¢˜æ‰€åœ¨ã€‚

## ğŸ¯ **å¿«é€Ÿæµ‹è¯•å‘½ä»¤**

å¤åˆ¶ä»¥ä¸‹å‘½ä»¤ç›´æ¥åœ¨åä¸ºäº‘IoTå¹³å°æµ‹è¯•ï¼š

```json
{
  "service_id": "smartHome",
  "command_name": "control_motor",
  "paras": {
    "enable": false
  }
}
```

å¦‚æœè¿™ä¸ªå‘½ä»¤ä»ç„¶æ— æ•ˆï¼Œé—®é¢˜å¯èƒ½åœ¨äºï¼š
1. åä¸ºäº‘å¹³å°é…ç½®
2. ç½‘ç»œè¿æ¥
3. è®¾å¤‡è®¤è¯
4. JSONæ ¼å¼å¤„ç†

è¯·æŒ‰ç…§è°ƒè¯•æ­¥éª¤é€ä¸€æ’æŸ¥ï¼
