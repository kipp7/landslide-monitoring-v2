## 0. 窗口与体验（基础壳能力）
- [x] 0.1 真全屏覆盖任务栏（使用 `rcMonitor`）
- [x] 0.2 热键仅在窗口激活时生效（F11/ESC）
- [x] 0.3 Win11 圆角/深色标题栏/Mica（支持则启用）
- [x] 0.4 单实例运行（第二次启动激活已有窗口）
- [x] 0.5 窗口位置/尺寸持久化（多显示器/分辨率变化保护）
- [x] 0.6 未处理异常写入崩溃日志（LocalAppData）
- [ ] 0.7 帧率/流畅度专项优化（WebView2/WPF）
- [x] 0.8 确认 WebView2 硬件加速与 GPU 进程策略（必要时提供开关）
- [x] 0.9 增加低性能模式：限制动效/降低渲染压力（前端联动）
- [ ] 0.10 提供性能观测：开发态显示 FPS/渲染耗时（可选）
- [ ] 0.11 优化启动体验：延迟初始化非关键逻辑（避免启动卡顿）
- [ ] 0.12 处理高 DPI 缩放：窗口/网页缩放一致且可诊断
- [ ] 0.13 多显示器切换：全屏/恢复窗口时优先落在当前显示器
- [ ] 0.14 崩溃后恢复：下次启动提示并提供“清理 WebView2 缓存”入口（可选）

## 1. 系统托盘（Tray）
- [x] 1.1 添加托盘图标与资源（含多分辨率 ico）
- [x] 1.2 托盘右键菜单：打开主窗口、切换全屏、打开设置、退出
- [x] 1.3 主窗口最小化到托盘（最小化时隐藏任务栏图标）
- [x] 1.4 托盘单击/双击行为：显示并激活窗口
- [x] 1.5 托盘提示气泡（可用于“更新可用/告警通知”）
- [x] 1.6 设置项：最小化/关闭到托盘行为可配置
- [x] 1.7 设置项：托盘启用/禁用（禁用时允许直接关闭退出）
- [x] 1.8.1 托盘菜单：显示版本号
- [x] 1.8.2 托盘菜单：打开日志目录
- [x] 1.9 托盘提示：点击可跳转指定路由（告警/更新）
- [ ] 1.10 托盘图标状态：告警时变色/叠加 badge（可选）

## 2. Windows 通知（Toast）
- [ ] 2.1 引入 Toast 通知实现（Win11 优先）
- [ ] 2.2 定义通知通道：告警、系统、更新
- [ ] 2.3 在桌面端设置页提供“允许通知”开关与状态显示
- [ ] 2.4 处理通知权限不足场景（给出引导文案/跳转设置页）
- [ ] 2.5 设计通知点击行为（打开应用并跳转到指定页面）
- [ ] 2.6 选择 Toast 实现方案（WinRT/CommunityToolkit/Notifications）
- [ ] 2.7 集成 AppUserModelID（Toast 要求）并适配安装方式
- [ ] 2.8 Toast 通知模板：标题/正文/按钮（至少 1 种）
- [ ] 2.9 Toast 点击回调：唤起应用并跳转 route（与 deep link 协同）
- [x] 2.10 设置页增加“发送测试通知”按钮

## 3. 开机自启（可选）
- [ ] 3.1 选择实现方式（注册表 Run / 计划任务）
- [ ] 3.2 在设置页提供开关（默认关闭）
- [ ] 3.3 启用/禁用时给出明确提示与错误信息
- [ ] 3.4 在不同安装方式（MSIX/非 MSIX）下验证行为

## 4. 深链接（Protocol Handler）
- [ ] 4.1 注册 `landslide://` 协议（安装时注册）
- [ ] 4.2 支持参数：`/route?path=/app/gps-monitoring&stationId=...`
- [ ] 4.3 第二次启动时将 deep link 传递给已运行实例并激活窗口
- [ ] 4.4 Host Bridge：允许前端请求“复制 deep link / 打开 deep link”

## 5. 原生文件对话框（导入/导出）
- [x] 5.1 Host Bridge：`export:file`（SaveFileDialog）
- [x] 5.2 Host Bridge：`import:file`（OpenFileDialog）
- [x] 5.3 统一文件类型过滤（csv/xlsx/json/png）
- [x] 5.4 处理取消/权限/路径非法等异常场景

## 6. 诊断与日志
- [ ] 6.1 定义日志目录与轮转策略（LocalAppData）
- [x] 6.2 增加“打开日志目录”动作（Host Bridge）
- [ ] 6.3 增加“复制版本信息/运行环境”动作（Host Bridge）
- [ ] 6.4 增加内置诊断页（Web UI 或原生对话框均可）
- [x] 6.5 提供“一键导出诊断包”（日志 + 配置 + 版本信息）

## 7. Host Bridge 协议完善
- [x] 7.1 统一消息格式（type/action/payload）
- [x] 7.2.1 动作：`show`, `hide`
- [x] 7.2.2 动作：`focus`
- [x] 7.2.3 动作：`toggleTray`
- [x] 7.2.4 动作：`notify`（先托盘气泡，后 Toast）
- [x] 7.3 增加返回值/回执机制（WebMessage -> WebMessage response）
- [ ] 7.4 增加权限边界：仅允许白名单动作，拒绝任意 shell 执行
- [x] 7.5 增加 `getAppInfo` 动作：版本/运行模式/系统信息（脱敏）
- [x] 7.6 增加 `openLogsDir` 动作：打开日志目录（Explorer）
- [x] 7.7 增加 `clearWebViewData` 动作：清理 WebView2 UserData（需确认提示）

## 8. 验收与文档
- [x] 8.1 更新 `apps/desk-win/README.md`（开发/发布/常见问题）
- [ ] 8.2 增加“交付验收清单”（托盘/通知/自启/深链接/文件对话框）
- [ ] 8.3 录制一段桌面端演示流程（可选）
- [ ] 8.4 增加桌面端自测脚本/清单（PowerShell）：启动/托盘/全屏/通知/退出

## 9. 帧率与性能优化（WebView2/WPF）
- [ ] 9.1 明确“低帧率”体验定义：场景、阈值与采样方式
- [ ] 9.2 增加可选性能 HUD：显示 FPS/渲染耗时/CPU 核心数（开发态）
- [ ] 9.3 性能 HUD 开关：环境变量或设置页开关（默认关闭）
- [ ] 9.4 诊断输出：记录 WebView2 进程信息与 GPU 状态（脱敏）
- [ ] 9.5 启动优化：延迟初始化非关键逻辑（托盘/菜单/扫描）避免首屏卡顿
- [ ] 9.6 优化加载遮罩：仅在导航或重载时显示，避免频繁闪烁
- [ ] 9.7 增加“低性能模式”更强降级：禁用动画/降低帧率（与前端联动）
- [ ] 9.8 提供“禁用 GPU”开关的引导文案（仅排障，不作为默认）
- [ ] 9.9 WebView2 参数调优：收集可选 AdditionalBrowserArguments 清单与说明
- [ ] 9.10 增加 DPI 诊断：输出系统 DPI、窗口 DPI、WebView2 缩放信息
- [ ] 9.11 多显示器切换：全屏/恢复时优先落在当前显示器并保持 DPI 一致
- [ ] 9.12 全屏体验：避免切换时黑屏/闪烁（必要时增加过渡遮罩）
- [ ] 9.13 资源释放：关闭时确保 WebView2/托盘/文件句柄释放无泄漏
- [ ] 9.14 增加“清理缓存后重启”流程（可选，提升现场排障效率）
- [ ] 9.15 验收：低性能机器下开启“低性能模式”后帧率显著提升

## 10. Windows Toast 通知落地（Win11 优先）
- [ ] 10.1 选择 Toast 实现库并记录原因（WinRT/CommunityToolkit）
- [ ] 10.2 配置 AppUserModelID（与安装方式兼容）
- [ ] 10.3 增加 Toast 通道：告警/系统/更新（可按 tag 分类）
- [ ] 10.4 设计 Toast 模板：标题/正文/时间/等级色（至少 1 种）
- [ ] 10.5 Toast 权限检测：未开启时给出引导（系统设置路径说明）
- [ ] 10.6 设置页：增加“允许通知”开关与状态显示（桌面端）
- [ ] 10.7 通知点击回调：唤起应用并跳转路由（与 deep link 协同）
- [ ] 10.8 支持通知按钮：打开告警中心/静默 1h（可选）
- [ ] 10.9 支持“静默时段”策略（夜间不弹，改托盘提示）
- [ ] 10.10 支持“重复告警合并”策略（避免刷屏）
- [ ] 10.11 提供通知测试用例：模拟不同等级告警（前端按钮触发）
- [ ] 10.12 兼容托盘气泡：Toast 不可用时自动降级
- [ ] 10.13 通知与日志：记录通知发送结果（成功/失败原因）
- [ ] 10.14 文档：通知权限与常见问题（企业环境策略限制等）
- [ ] 10.15 验收：告警通知点击可稳定唤起并跳转到告警详情

## 11. 深链接（Protocol Handler）与路由跳转
- [ ] 11.1 定义 deep link 规范：`landslide://route?path=/app/...&stationId=...`
- [ ] 11.2 解析命令行参数：启动时识别 deep link 并保存到待处理队列
- [ ] 11.3 单实例传递：第二次启动携带 deep link 时转发给已运行实例
- [ ] 11.4 已运行实例接收 deep link 后：激活窗口并导航到目标路由
- [ ] 11.5 Host Bridge：增加 `copyDeepLink` 动作（复制到剪贴板）
- [ ] 11.6 Host Bridge：增加 `openDeepLink` 动作（触发系统打开）
- [ ] 11.7 与 Toast 联动：通知点击携带 deep link 跳转
- [ ] 11.8 与托盘联动：托盘提示点击支持 deep link 跳转
- [ ] 11.9 安全校验：仅允许白名单路由/参数（防止任意跳转）
- [ ] 11.10 文档：deep link 格式与示例（告警/站点/GPS）

## 12. 安全与权限边界（Host Bridge）
- [ ] 12.1 Bridge 动作白名单：集中定义允许的 action 列表
- [ ] 12.2 Payload 校验：每个 action 定义 schema（缺字段返回错误）
- [ ] 12.3 限制 `writeTextFile`：仅允许用户选择的路径或 AppData 子目录
- [ ] 12.4 限制导出诊断包：默认输出到用户选择路径，禁止系统目录
- [ ] 12.5 外链打开策略：仅允许 http/https，禁止 file:// 等
- [ ] 12.6 记录拒绝原因：写入日志（便于排障与安全审计）
- [ ] 12.7 增加“安全模式”开关：禁用高风险动作（可选）
- [ ] 12.8 关闭 DevTools 策略审查：生产环境确保禁用
- [ ] 12.9 文档：桥接能力清单与安全边界说明
- [ ] 12.10 验收：恶意 payload 无法触发任意文件写入或进程执行
