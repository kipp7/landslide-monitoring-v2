## 1. 设计 API Contract 与 DTO
- [ ] 1.1 盘点 `apps/desk` 当前页面所需数据模型（设备、站点、GNSS、告警等）
- [ ] 1.2 定义通用类型：`Id`、`Timestamp`、`PageRequest`、`PageResponse`
- [ ] 1.3 定义时间范围/粒度枚举（用于趋势与历史）
- [ ] 1.4 定义错误模型：`ApiError`（code/message/details/retryable）
- [ ] 1.5 定义分页/排序/过滤通用参数（sortBy/sortOrder/filters）
- [x] 1.6 定义枚举：设备类型、传感器类型、在线状态、告警等级
- [ ] 1.7 定义 GIS/地图模型：经纬度、坐标系、边界框
- [x] 1.8 定义监测站模型：`StationSummary`/`StationDetail`
- [x] 1.9 定义设备模型：`DeviceSummary`/`DeviceDetail`/`DeviceStatus`
- [ ] 1.10 定义传感器模型：`SensorSummary`/`SensorDetail`/`TelemetryPoint`
- [ ] 1.11 定义时间序列响应：`TimeseriesPoint`/`Series`/`DownsampledSeries`
- [ ] 1.12 定义导出模型：`ExportJob`/`ExportFormat`（先用于 mock）

## 2. API Provider 抽象
- [x] 2.1 定义 `DeskApi` 接口（按 domain 分组：auth/stations/devices/gps/alerts）
- [x] 2.2 Mock 实现：数据工厂 + 可控延迟 + 失败注入（用于演示与测试）
- [x] 2.3 HTTP 实现骨架：baseUrl/token/headers/timeout（先不联调）
- [ ] 2.4 HTTP 实现：统一 request 封装（超时/重试/headers）
- [ ] 2.5 支持请求取消（AbortController）与竞态处理（最新请求覆盖旧请求）
- [ ] 2.6 支持缓存策略（内存缓存：列表/详情短缓存）
- [x] 2.7 统一鉴权 token 存取（localStorage/sessionStorage）
- [x] 2.8 统一 baseUrl 配置与环境切换（dev/mock/http）
- [ ] 2.9 Provider 侧基础埋点：请求耗时、失败率（先 console）
- [ ] 2.10 为关键方法补齐示例与注释（便于其他 AI 并行开发）

## 3. Mock 数据体系
- [ ] 3.1 建立可复现 seed（刷新页面不“跳变”）
- [ ] 3.2 建立数据关联：站点-设备-传感器-测点关系一致
- [ ] 3.3 支持筛选与分页（至少前端侧模拟）
- [ ] 3.4 支持时间序列生成（GPS/雨量/倾角等）
- [ ] 3.5 数据工厂：站点生成器（地理分布 + 风险等级）
- [ ] 3.6 数据工厂：设备生成器（类型、厂家、序列号、固件）
- [ ] 3.7 数据工厂：传感器生成器（与设备类型匹配）
- [ ] 3.8 时间序列：支持不同规律（周期、噪声、突变、缺失）
- [ ] 3.9 告警事件：按阈值/规则触发并可复现
- [ ] 3.10 支持实时数据刷新模拟（轮询/定时增量）
- [ ] 3.11 支持 CRUD 的乐观更新模拟（新增/编辑/删除）
- [ ] 3.12 支持失败注入：按 endpoint/概率/一次性失败

## 4. 错误与提示
- [ ] 4.1 统一错误映射：网络错误/超时/401/500/校验错误
- [ ] 4.2 统一消息提示策略（AntD message/notification）
- [ ] 4.3 为关键操作增加“可重试”路径（重试按钮/自动重试可选）
- [ ] 4.4 表单提交校验错误结构（fieldErrors）与 UI 映射
- [ ] 4.5 页面级错误输出统一（ApiError -> 可读提示 + 详情）
- [ ] 4.6 离线模式提示策略（网络断开时降级到 mock）

## 5. 切换与配置
- [x] 5.1 设置页支持切换数据源：Mock / HTTP（持久化）
- [ ] 5.2 增加 `DESK_API_MODE` 环境变量（默认 mock）
- [ ] 5.3 调试面板：显示当前模式/baseUrl/最近请求（仅开发态）
- [ ] 5.4 快速重置 mock 数据（清 seed/重建数据）

## 6. 验证与演示
- [ ] 6.1 Mock 模式：全页面数据一致性检查（站点/设备/GPS）
- [ ] 6.2 HTTP 模式：可切换且不会导致页面崩溃（接口不可用也可进入页面）

## 7. ????? Contract/Mock/HTTP?????
- [ ] 7.1 [auth.login] ?? request/response DTO ???????????/???
- [ ] 7.2 [auth.login] Mock ????????/???????????/???
- [ ] 7.3 [auth.login] HTTP ???????/??/???????????/???
- [ ] 7.4 [auth.login] ?? hook/?????????????????????/???
- [ ] 7.5 [auth.login] Contract ???????/??/??/??????????/???
- [ ] 7.6 [auth.whoami] ?? request/response DTO ?????????????????/???
- [ ] 7.7 [auth.whoami] Mock ????????/?????????????????/???
- [ ] 7.8 [auth.whoami] HTTP ???????/??/?????????????????/???
- [ ] 7.9 [auth.whoami] ?? hook/???????????????????????????/???
- [ ] 7.10 [auth.whoami] Contract ???????/??/??/????????????????/???
- [ ] 7.11 [stations.list] ?? request/response DTO ??????????????/??/???
- [ ] 7.12 [stations.list] Mock ????????/??????????????/??/???
- [ ] 7.13 [stations.list] HTTP ???????/??/??????????????/??/???
- [ ] 7.14 [stations.list] ?? hook/????????????????????????/??/???
- [ ] 7.15 [stations.list] Contract ???????/??/??/?????????????/??/???
- [ ] 7.16 [stations.get] ?? request/response DTO ???????????????/??????
- [ ] 7.17 [stations.get] Mock ????????/???????????????/??????
- [ ] 7.18 [stations.get] HTTP ???????/??/???????????????/??????
- [ ] 7.19 [stations.get] ?? hook/?????????????????????????/??????
- [ ] 7.20 [stations.get] Contract ???????/??/??/??????????????/??????
- [ ] 7.21 [stations.create] ?? request/response DTO ?????????????????
- [ ] 7.22 [stations.create] Mock ????????/?????????????????
- [ ] 7.23 [stations.create] HTTP ???????/??/?????????????????
- [ ] 7.24 [stations.create] ?? hook/???????????????????????????
- [ ] 7.25 [stations.create] Contract ???????/??/??/????????????????
- [ ] 7.26 [stations.update] ?? request/response DTO ?????????????????
- [ ] 7.27 [stations.update] Mock ????????/?????????????????
- [ ] 7.28 [stations.update] HTTP ???????/??/?????????????????
- [ ] 7.29 [stations.update] ?? hook/???????????????????????????
- [ ] 7.30 [stations.update] Contract ???????/??/??/????????????????
- [ ] 7.31 [stations.delete] ?? request/response DTO ?????????????????
- [ ] 7.32 [stations.delete] Mock ????????/?????????????????
- [ ] 7.33 [stations.delete] HTTP ???????/??/?????????????????
- [ ] 7.34 [stations.delete] ?? hook/???????????????????????????
- [ ] 7.35 [stations.delete] Contract ???????/??/??/????????????????
- [ ] 7.36 [devices.list] ?? request/response DTO ??????????????/?????
- [ ] 7.37 [devices.list] Mock ????????/??????????????/?????
- [ ] 7.38 [devices.list] HTTP ???????/??/??????????????/?????
- [ ] 7.39 [devices.list] ?? hook/????????????????????????/?????
- [ ] 7.40 [devices.list] Contract ???????/??/??/?????????????/?????
- [ ] 7.41 [devices.get] ?? request/response DTO ??????????????????
- [ ] 7.42 [devices.get] Mock ????????/??????????????????
- [ ] 7.43 [devices.get] HTTP ???????/??/??????????????????
- [ ] 7.44 [devices.get] ?? hook/????????????????????????????
- [ ] 7.45 [devices.get] Contract ???????/??/??/?????????????????
- [ ] 7.46 [devices.update] ?? request/response DTO ????????????????
- [ ] 7.47 [devices.update] Mock ????????/????????????????
- [ ] 7.48 [devices.update] HTTP ???????/??/????????????????
- [ ] 7.49 [devices.update] ?? hook/??????????????????????????
- [ ] 7.50 [devices.update] Contract ???????/??/??/???????????????
- [ ] 7.51 [devices.delete] ?? request/response DTO ??????????????
- [ ] 7.52 [devices.delete] Mock ????????/??????????????
- [ ] 7.53 [devices.delete] HTTP ???????/??/??????????????
- [ ] 7.54 [devices.delete] ?? hook/????????????????????????
- [ ] 7.55 [devices.delete] Contract ???????/??/??/?????????????
- [ ] 7.56 [devices.getStatus] ?? request/response DTO ?????????????/??/??/?????
- [ ] 7.57 [devices.getStatus] Mock ????????/?????????????/??/??/?????
- [ ] 7.58 [devices.getStatus] HTTP ???????/??/?????????????/??/??/?????
- [ ] 7.59 [devices.getStatus] ?? hook/???????????????????????/??/??/?????
- [ ] 7.60 [devices.getStatus] Contract ???????/??/??/????????????/??/??/?????
- [ ] 7.61 [devices.controlAction] ?? request/response DTO ???????????????/??/??????
- [ ] 7.62 [devices.controlAction] Mock ????????/???????????????/??/??????
- [ ] 7.63 [devices.controlAction] HTTP ???????/??/???????????????/??/??????
- [ ] 7.64 [devices.controlAction] ?? hook/?????????????????????????/??/??????
- [ ] 7.65 [devices.controlAction] Contract ???????/??/??/??????????????/??/??????
- [ ] 7.66 [sensors.listByDevice] ?? request/response DTO ?????????????????/???
- [ ] 7.67 [sensors.listByDevice] Mock ????????/?????????????????/???
- [ ] 7.68 [sensors.listByDevice] HTTP ???????/??/?????????????????/???
- [ ] 7.69 [sensors.listByDevice] ?? hook/???????????????????????????/???
- [ ] 7.70 [sensors.listByDevice] Contract ???????/??/??/????????????????/???
- [ ] 7.71 [sensors.getLatestTelemetry] ?? request/response DTO ????????????????????
- [ ] 7.72 [sensors.getLatestTelemetry] Mock ????????/????????????????????
- [ ] 7.73 [sensors.getLatestTelemetry] HTTP ???????/??/????????????????????
- [ ] 7.74 [sensors.getLatestTelemetry] ?? hook/??????????????????????????????
- [ ] 7.75 [sensors.getLatestTelemetry] Contract ???????/??/??/???????????????????
- [ ] 7.76 [sensors.getTimeseries] ?? request/response DTO ??????????????????
- [ ] 7.77 [sensors.getTimeseries] Mock ????????/??????????????????
- [ ] 7.78 [sensors.getTimeseries] HTTP ???????/??/??????????????????
- [ ] 7.79 [sensors.getTimeseries] ?? hook/????????????????????????????
- [ ] 7.80 [sensors.getTimeseries] Contract ???????/??/??/?????????????????
- [ ] 7.81 [gps.getLatest] ?? request/response DTO ??????GPS ???????/?????
- [ ] 7.82 [gps.getLatest] Mock ????????/??????GPS ???????/?????
- [ ] 7.83 [gps.getLatest] HTTP ???????/??/??????GPS ???????/?????
- [ ] 7.84 [gps.getLatest] ?? hook/????????????????GPS ???????/?????
- [ ] 7.85 [gps.getLatest] Contract ???????/??/??/?????GPS ???????/?????
- [ ] 7.86 [gps.getTimeseries] ?? request/response DTO ??????GPS ???????X/Y/Z/????
- [ ] 7.87 [gps.getTimeseries] Mock ????????/??????GPS ???????X/Y/Z/????
- [ ] 7.88 [gps.getTimeseries] HTTP ???????/??/??????GPS ???????X/Y/Z/????
- [ ] 7.89 [gps.getTimeseries] ?? hook/????????????????GPS ???????X/Y/Z/????
- [ ] 7.90 [gps.getTimeseries] Contract ???????/??/??/?????GPS ???????X/Y/Z/????
- [ ] 7.91 [gps.getBaselines] ?? request/response DTO ??????GPS ??????/?????
- [ ] 7.92 [gps.getBaselines] Mock ????????/??????GPS ??????/?????
- [ ] 7.93 [gps.getBaselines] HTTP ???????/??/??????GPS ??????/?????
- [ ] 7.94 [gps.getBaselines] ?? hook/????????????????GPS ??????/?????
- [ ] 7.95 [gps.getBaselines] Contract ???????/??/??/?????GPS ??????/?????
- [ ] 7.96 [alerts.list] ?? request/response DTO ?????????????/??/?????
- [ ] 7.97 [alerts.list] Mock ????????/?????????????/??/?????
- [ ] 7.98 [alerts.list] HTTP ???????/??/?????????????/??/?????
- [ ] 7.99 [alerts.list] ?? hook/???????????????????????/??/?????
- [ ] 7.100 [alerts.list] Contract ???????/??/??/????????????/??/?????
- [ ] 7.101 [alerts.get] ?? request/response DTO ?????????????????
- [ ] 7.102 [alerts.get] Mock ????????/?????????????????
- [ ] 7.103 [alerts.get] HTTP ???????/??/?????????????????
- [ ] 7.104 [alerts.get] ?? hook/???????????????????????????
- [ ] 7.105 [alerts.get] Contract ???????/??/??/????????????????
- [ ] 7.106 [alerts.ack] ?? request/response DTO ???????????Ack???
- [ ] 7.107 [alerts.ack] Mock ????????/???????????Ack???
- [ ] 7.108 [alerts.ack] HTTP ???????/??/???????????Ack???
- [ ] 7.109 [alerts.ack] ?? hook/?????????????????????Ack???
- [ ] 7.110 [alerts.ack] Contract ???????/??/??/??????????Ack???

## 8. ??? API ?????????????
- [ ] 8.1 ?????? API ??????????/??/???
- [ ] 8.2 ????/??/???/GPS/????????????? DeskApi?
- [ ] 8.3 ???????? payload?mock??????
- [ ] 8.4 ?????????????ApiError -> UI?
- [ ] 8.5 ????/??/????????? filters ???
- [ ] 8.6 ??????/?????UTC/????????
- [ ] 8.7 ???? contract?CSV/PNG????????
- [ ] 8.8 ???????token ????????whoami?
- [ ] 8.9 ?????????DESK_API_MODE / DESK_API_BASE_URL?
- [ ] 8.10 ???? smoke ?????? mock ?????? HTTP?
